(function(e){function t(t){for(var a,i,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(p.length)p.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={app:0},o=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("85ec"),r=n.n(a);r.a},"2b91":function(e,t,n){"use strict";var a=n("3c56"),r=n.n(a);r.a},"3c56":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("v-app",[n("v-app-bar",{attrs:{dark:"",absolute:""}},[n("v-app-bar-nav-icon",{on:{click:function(t){e.drawer=!0}}}),n("v-toolbar-title",[e._v("Tracert App")]),n("v-spacer"),n("button",{on:{click:e.signOut}},[e._v("Sign out")])],1),n("v-navigation-drawer",{attrs:{absolute:"",temporary:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("v-list",{attrs:{nav:"",dense:""}},[e._l(e.nav_lists,(function(t){return[t.lists?n("v-list-group",{key:t.name,attrs:{"no-action":"","prepend-icon":t.icon},scopedSlots:e._u([{key:"activator",fn:function(){return[n("v-list-item-content",[n("v-list-item-title",[e._v(" "+e._s(t.active)+e._s(t.name)+" ")])],1)]},proxy:!0}],null,!0),model:{value:t.active,callback:function(n){e.$set(t,"active",n)},expression:"nav_list.active"}},e._l(t.lists,(function(t){return n("v-list-item",{key:t.name,attrs:{to:t.link}},[n("v-list-item-title",[e._v(" "+e._s(t.name)+" ")])],1)})),1):n("v-list-item",{key:t.name,attrs:{to:t.link}},[n("v-list-item-icon",[n("v-icon",[e._v(e._s(t.icon))])],1),n("v-list-item-content",[n("v-list-item-title",[e._v(" "+e._s(t.name)+" ")])],1)],1)]}))],2)],1),n("div",{attrs:{id:"contents"}},[n("router-view")],1)],1)],1)},o=[],i=n("8aa50"),s=n.n(i),c={name:"App",data:function(){return{drawer:!1,nav_lists:[{name:"Register",icon:"mdi-arrow-up-bold-box-outline",link:"/"},{name:"Nodes",icon:"mdi-call-split",link:"/nodes"}]}},methods:{signOut:function(){var e=this;s.a.auth().signOut().then((function(){e.$router.push("/signin")}))}}},u=c,l=(n("034f"),n("2877")),d=n("6544"),p=n.n(d),v=n("7496"),m=n("40dc"),f=n("5bc1"),g=n("132d"),h=n("8860"),_=n("56b0"),w=n("da13"),b=n("5d23"),x=n("34c3"),y=n("f774"),V=n("2fa4"),k=n("2a7f"),C=Object(l["a"])(u,r,o,!1,null,null,null),P=C.exports;p()(C,{VApp:v["a"],VAppBar:m["a"],VAppBarNavIcon:f["a"],VIcon:g["a"],VList:h["a"],VListGroup:_["a"],VListItem:w["a"],VListItemContent:b["a"],VListItemIcon:x["a"],VListItemTitle:b["b"],VNavigationDrawer:y["a"],VSpacer:V["a"],VToolbarTitle:k["a"]});n("45fc"),n("96cf");var F=n("1da1"),U=n("8c4f"),T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.datas,(function(t){return n("v-list",{key:t.uid},[n("v-list-item",{attrs:{to:t.uid}},[e._v(e._s(t.name)+":"+e._s(t.detail)+" "),n("a",{attrs:{href:"http://localhost:8080/read/"+t.uuid}},[e._v(" http://localhost:8080/read/"+e._s(t.uuid)+" ")])])],1)})),1)},N=[],S=(n("4160"),n("159b"),n("d3b7"),n("59ca")),O=n.n(S),A=(n("ea7b"),{apiKey:"AIzaSyC3XAGyx4UcvU8s_qhiHzUPslJCti_kHcI",authDomain:"trace-app-2863a.firebaseapp.com",databaseURL:"https://trace-app-2863a.firebaseio.com",projectId:"trace-app-2863a",storageBucket:"trace-app-2863a.appspot.com",messagingSenderId:"999785118982",appId:"1:999785118982:web:38dd6da15c67174bb2b287",measurementId:"G-5EDX5VYNCK"});O.a.initializeApp(A),O.a.getCurrentUser=function(){return new Promise((function(e,t){var n=O.a.auth().onAuthStateChanged((function(t){n(),e(t)}),t)}))};var j=O.a,R={name:"Nodes",data:function(){return{datas:[]}},mounted:function(){var e=this,t=j.firestore().collection("nodes");t.where("owner","==",j.auth().currentUser.uid).get().then((function(t){t.forEach((function(t){e.datas.push(t.data())}))})).catch((function(e){console.log("Error getting documents",e)}))}},I=R,E=Object(l["a"])(I,T,N,!1,null,"0ff0229c",null),D=E.exports;p()(E,{VList:h["a"],VListItem:w["a"]});var $=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("v-card",{staticClass:"mx-auto",attrs:{"max-width":"344"}},[n("label",[e._v("商品情報")]),n("v-card-text",[e._v(" 商品名 "),n("v-text-field",{attrs:{label:"商品名","single-line":""},model:{value:e.inputProductName,callback:function(t){e.inputProductName=t},expression:"inputProductName"}}),e._v(" 詳細 "),n("v-text-field",{attrs:{label:"商品詳細","single-line":""},model:{value:e.inputProductDetail,callback:function(t){e.inputProductDetail=t},expression:"inputProductDetail"}})],1),n("v-card-actions",[n("v-btn",{staticClass:"ma-auto",attrs:{color:"primary"},on:{click:e.generate}},[e._v("生成 ")])],1)],1)],1),n("v-container",{staticStyle:{height:"80px"}},[n("v-row",{attrs:{"align-content":"center",justify:"center"}},[n("v-col",{attrs:{cols:"6"}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.progress,expression:"progress"}],attrs:{color:"deep-purple accent-4",indeterminate:"",rounded:"",height:"6"}})],1)],1)],1),e.targetText?n("vue-qrcode",{attrs:{value:e.targetText,options:e.option,tag:"img"}}):e._e(),n("div",[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.moving,expression:"moving"}],staticClass:"ma-auto",attrs:{color:"primary"},on:{click:e.move}},[e._v("Moving ")])],1)],1)},M=[],L=n("b2e5"),q=n.n(L),G=n("c64e"),z=n.n(G),B={name:"NodeRegister",components:{VueQrcode:q.a},data:function(){return{progress:!1,moving:!1,uuid:null,inputProductName:"",inputProductDetail:"",targetText:"",post_lng:null,post_lat:null,option:{errorCorrectionLevel:"M",maskPattern:0,margin:10,scale:2,width:300,color:{dark:"#000000FF",light:"#FFFFFFFF"}}}},methods:{generate:function(){var e=z()();j.firestore().collection("nodes").doc(e).set({uuid:e,owner:j.auth().currentUser.uid,name:this.inputProductName,detail:this.inputProductDetail,access:j.firestore.FieldValue.arrayUnion(j.auth().currentUser.uid),original_access:j.firestore.FieldValue.arrayUnion(j.auth().currentUser.uid),post_lat:null,post_lng:null}),this.uuid=e,this.targetText="http://localhost:8080/"+e,this.moving=!0},move:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.uuid,a=z()(),navigator.geolocation.getCurrentPosition((function(e){j.firestore().collection("nodes").doc(n).update({post_nodes:j.firestore.FieldValue.arrayUnion(a),post_lat:e.coords.latitude,post_lng:e.coords.longitude,open:!0})}),(function(){})),e.targetText="http://localhost:8080/write/"+n+"/"+a,console.log(e.targetText),e.progress=!0,t.next=8,W(20,a);case 8:e.targetText="http://localhost:8080/read/"+n,e.progress=!1,j.firestore().collection("nodes").doc(a).get().then((function(e){e.exists?(j.firestore().collection("nodes").doc(a).get().then((function(e){var t=e.data().owner;j.firestore().collection("nodes").doc(n).update({access:j.firestore.FieldValue.arrayUnion(t)})})),j.firestore().collection("nodes").doc(n).update({open:!1})):(console.log("ない"),j.firestore().collection("nodes").doc(n).update({post_nodes:j.firestore.FieldValue.arrayRemove(a),open:!1}))})).catch((function(){j.firestore().collection("nodes").doc(n).update({post_nodes:j.firestore.FieldValue.arrayRemove(a),open:!1})}));case 11:case"end":return t.stop()}}),t)})))()}}},W=function(e,t){return new Promise((function(n){var a=setInterval((function(){e-=1,e<=0&&(n(),clearTimeout(a)),j.firestore().collection("nodes").doc(t).get().then((function(e){e.exists&&(n(),clearTimeout(a))}))}),1e3)}))},J=B,H=(n("57e9"),n("8336")),K=n("b0af"),Q=n("99d9"),X=n("62ad"),Y=n("a523"),Z=n("490a"),ee=n("0fd9"),te=n("8654"),ne=Object(l["a"])(J,$,M,!1,null,"469ea7d6",null),ae=ne.exports;p()(ne,{VBtn:H["a"],VCard:K["a"],VCardActions:Q["a"],VCardText:Q["b"],VCol:X["a"],VContainer:Y["a"],VProgressCircular:Z["a"],VRow:ee["a"],VTextField:te["a"]});var re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("v-card",{staticClass:"mx-auto",attrs:{"max-width":"344"}},[n("label",[e._v("移動情報")]),n("v-card-text",[e._v(" 詳細 "),n("v-text-field",{attrs:{label:"詳細","single-line":""},model:{value:e.inputDetail,callback:function(t){e.inputDetail=t},expression:"inputDetail"}})],1),n("v-card-actions",[n("v-btn",{staticClass:"ma-auto",attrs:{color:"primary"},on:{click:e.record}},[e._v("記録 ")])],1)],1)],1),n("v-container",{staticStyle:{height:"80px"}},[n("v-row",{attrs:{"align-content":"center",justify:"center"}},[n("v-col",{attrs:{cols:"6"}},[n("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:e.progress,expression:"progress"}],attrs:{color:"deep-purple accent-4",indeterminate:"",rounded:"",height:"6"}})],1)],1)],1),e.targetText?n("vue-qrcode",{attrs:{value:e.targetText,options:e.option,tag:"img"}}):e._e(),n("div",[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.moving,expression:"moving"}],staticClass:"ma-auto",attrs:{color:"primary"},on:{click:e.move}},[e._v("Moving ")])],1)],1)},oe=[],ie={name:"NodeWrite",components:{VueQrcode:q.a},data:function(){return{pre_lat:null,pre_lng:null,post_lat:null,post_lng:null,progress:!1,moving:!1,pre_uuid:this.$route.params.pre_node_id,uuid:this.$route.params.node_id,inputDetail:"",targetText:"",option:{errorCorrectionLevel:"M",maskPattern:0,margin:10,scale:2,width:300,color:{dark:"#000000FF",light:"#FFFFFFFF"}}}},mounted:function(){var e=this.uuid,t=this.pre_uuid;navigator.geolocation.getCurrentPosition((function(n){j.firestore().collection("nodes").doc(e).set({uuid:e,pre_nodes:j.firestore.FieldValue.arrayUnion(t),owner:j.auth().currentUser.uid,access:j.firestore.FieldValue.arrayUnion(j.auth().currentUser.uid),original_access:j.firestore.FieldValue.arrayUnion(j.auth().currentUser.uid),pre_lat:n.coords.latitude,pre_lng:n.coords.longitude,post_lat:null,post_lng:null,open:!1})}),(function(){console.log("bad")})),j.firestore().collection("nodes").doc(t).get().then((function(t){t.data().original_access.forEach((function(t){console.log("access"+t),j.firestore().collection("nodes").doc(e).update({access:j.firestore.FieldValue.arrayUnion(t),original_access:j.firestore.FieldValue.arrayUnion(t)})}))}))},methods:{record:function(){var e=this.inputDetail;j.firestore().collection("nodes").doc(this.uuid).update({detail:e}),this.targetText="http://localhost:8080/read/"+this.uuid,this.moving=!0},move:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.uuid,a=z()(),navigator.geolocation.getCurrentPosition((function(e){j.firestore().collection("nodes").doc(n).update({uuid:n,post_nodes:j.firestore.FieldValue.arrayUnion(a),post_lat:e.coords.latitude,post_lng:e.coords.longitude,open:!0})}),(function(){})),e.targetText="http://localhost:8080/write/"+n+"/"+a,console.log(e.targetText),e.progress=!0,t.next=8,se(2e4);case 8:e.targetText="http://localhost:8080/read/"+n,e.progress=!1,j.firestore().collection("nodes").doc(a).get().then((function(e){e.exists?(j.firestore().collection("nodes").doc(a).get().then((function(e){j.firestore().collection("nodes").doc(n).update({access:j.firestore.FieldValue.arrayUnion(e.data().owner)})})),j.firestore().collection("nodes").doc(n).update({open:!1})):j.firestore().collection("nodes").doc(n).update({post_nodes:j.firestore.FieldValue.arrayRemove(a),open:!1})})).catch((function(){j.firestore().collection("nodes").doc(n).update({post_nodes:j.firestore.FieldValue.arrayRemove(a),open:!1})}));case 11:case"end":return t.stop()}}),t)})))()}}},se=function(e){return new Promise((function(t){return setTimeout((function(){return t()}),e)}))},ce=ie,ue=(n("6db6"),Object(l["a"])(ce,re,oe,!1,null,"d36e9116",null)),le=ue.exports;p()(ue,{VBtn:H["a"],VCard:K["a"],VCardActions:Q["a"],VCardText:Q["b"],VCol:X["a"],VContainer:Y["a"],VProgressCircular:Z["a"],VRow:ee["a"],VTextField:te["a"]});var de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("who:"+e._s(e.who))]),n("p",[e._v("name:"+e._s(e.data.name))]),n("p",[e._v("detail:"+e._s(e.data.detail))]),n("v-container",{staticClass:"grey lighten-5"},[n("v-row",{staticClass:"mb-6",attrs:{"no-gutters":""}},[n("v-col",[n("p",[e._v("受け取り場所")]),n("GmapMap",{staticStyle:{width:"350px",height:"300px"},attrs:{center:{lat:e.data.pre_lat,lng:e.data.pre_lng},zoom:13,"map-type-id":"roadmap"}},[n("GmapMarker",{attrs:{position:{lat:e.data.pre_lat,lng:e.data.pre_lng}}})],1),n("v-card",{staticClass:"pa-2",attrs:{outlined:"",tile:""}},[n("p",[e._v("前へ")]),e._l(e.data.pre_nodes,(function(t){return n("v-list",{key:t},[n("a",{attrs:{href:"http://localhost:8080/read/"+t}},[e._v(" http://localhost:8080/read/"+e._s(t)+" ")])])}))],2)],1),n("v-col",[n("p",[e._v("受け渡し場所")]),n("GmapMap",{staticStyle:{width:"350px",height:"300px"},attrs:{center:{lat:e.data.post_lat,lng:e.data.post_lng},zoom:13,"map-type-id":"roadmap"}},[n("GmapMarker",{attrs:{position:{lat:e.data.post_lat,lng:e.data.post_lng}}})],1),n("v-card",{staticClass:"pa-2",attrs:{outlined:"",tile:""}},[n("p",[e._v("次へ")]),e._l(e.data.post_nodes,(function(t){return n("v-list",{key:t},[n("a",{attrs:{href:"http://localhost:8080/read/"+t}},[e._v(" http://localhost:8080/read/"+e._s(t)+" ")])])}))],2)],1)],1)],1)],1)},pe=[],ve={name:"NodeRead",data:function(){return{who:null,data:null}},mounted:function(){var e=this;j.firestore().collection("nodes").doc(this.$route.params.node_id).get().then((function(t){e.data=t.data(),j.firestore().collection("users").doc(t.data().owner).get().then((function(t){e.who=t.data().email}))})).catch((function(e){console.log("Error getting documents",e)})),console.log(this.data)}},me=ve,fe=Object(l["a"])(me,de,pe,!1,null,"b9628f92",null),ge=fe.exports;p()(fe,{VCard:K["a"],VCol:X["a"],VContainer:Y["a"],VList:h["a"],VRow:ee["a"]});var he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"signup"},[n("h2",[e._v("Sign up")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",placeholder:"Username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),n("button",{on:{click:e.createUserAccount}},[e._v("Register")]),n("p",[e._v("Do you have an account? "),n("router-link",{attrs:{to:"/signin"}},[e._v("sign in now!!")])],1)])},_e=[],we={name:"Signup",data:function(){return{username:"",password:""}},methods:{createUserAccount:function(){var e=this;console.log(this.username,this.password),j.auth().createUserWithEmailAndPassword(this.username,this.password).then((function(t){console.log(t.user.email),j.firestore().collection("users").doc(t.user.uid).set({uuid:t.user.uid,email:t.user.email}),e.$router.push("/signin")})).catch((function(e){alert(e.message)}))}}},be=we,xe=Object(l["a"])(be,he,_e,!1,null,"6008f8cd",null),ye=xe.exports,Ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"signin"},[n("h2",[e._v("Sign in")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",placeholder:"Username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),n("button",{on:{click:e.signindo}},[e._v("Signin")]),n("p",[e._v("You don't have an account? "),n("router-link",{attrs:{to:"/signup"}},[e._v("create account now!!")])],1)])},ke=[],Ce={name:"Signin",data:function(){return{username:"",password:""}},methods:{signindo:function(){var e=this;j.auth().signInWithEmailAndPassword(this.username,this.password).then((function(){e.$router.push("/")}),(function(e){alert(e.message)}))}}},Pe=Ce,Fe=(n("2b91"),Object(l["a"])(Pe,Ve,ke,!1,null,"0abb44b1",null)),Ue=Fe.exports;a["a"].use(U["a"]);var Te=new U["a"]({mode:"history",routes:[{path:"/signup",name:"Signup",component:ye},{path:"/signin",name:"Signin",component:Ue},{path:"/",name:"NodeRegister",component:ae,meta:{requiresAuth:!0}},{path:"/write/:pre_node_id/:node_id",name:"NodeWrite",component:le,meta:{requiresAuth:!0}},{path:"/nodes",name:"Nodes",component:D,meta:{requiresAuth:!0}},{path:"/read/:node_id",name:"NodeRead",component:ge,meta:{requiresAuth:!0}}]});Te.beforeEach(function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(t,n,a){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.matched.some((function(e){return e.meta.requiresAuth})),e.t0=r,!e.t0){e.next=6;break}return e.next=5,j.getCurrentUser();case 5:e.t0=!e.sent;case 6:if(!e.t0){e.next=10;break}a({path:"/signin",query:{redirect:t.fullPath}}),e.next=11;break;case 10:a();case 11:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}());var Ne=Te,Se=n("f309");a["a"].use(Se["a"]);var Oe=new Se["a"]({}),Ae=n("2f62");a["a"].use(Ae["a"]);var je=new Ae["a"].Store({strict:!0,state:{email:"",status:!1},getters:{email:function(e){return e.email},isSignedIn:function(e){return e.status}},mutations:{onAuthEmailChanged:function(e,t){e.email=t},onUserStatusChanged:function(e,t){e.status=t}}}),Re=n("755e");a["a"].use(Re,{load:{key:"AIzaSyA_Wuqit039d-1ICE9poeA_0Eb5O1VNt0M",libraries:"places",region:"JP",language:"ja"}}),a["a"].config.productionTip=!1,new a["a"]({el:"#app",router:Ne,vuetify:Oe,store:je,render:function(e){return e(P)}})},"57e9":function(e,t,n){"use strict";var a=n("919a"),r=n.n(a);r.a},6542:function(e,t,n){},"6db6":function(e,t,n){"use strict";var a=n("6542"),r=n.n(a);r.a},"85ec":function(e,t,n){},"919a":function(e,t,n){}});
//# sourceMappingURL=app.240f92aa.js.map